(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[44],{1682:(e,a,t)=>{"use strict";t.d(a,{D:()=>h});var l=t(8045),s=t(5177),r=t(8227),i=t(3896),n=t(5086),d=t(6389),c=t(2989),o=t(9062);function h(e){let{onImageUpload:a,onImageRemove:t,className:h="",accept:u="image/*",maxSize:x=10,uploadedImage:m=null,disabled:v=!1}=e,b=(0,s.useRef)(null),[g,p]=(0,s.useState)(!1),[f,j]=(0,s.useState)(null),[y,w]=(0,s.useState)(!1),N=(0,s.useCallback)(e=>"image/*"!==u||e.type.startsWith("image/")?"video/*"!==u||e.type.startsWith("video/")?"image/*"===u||"video/*"===u||u.split(",").map(e=>e.trim()).some(a=>"*/*"===a||(a.endsWith("/*")?e.type.startsWith(a.slice(0,-2)):e.type===a))?e.size/1048576>x?"文件大小不能超过".concat(x,"MB"):null:"请上传支持的文件类型: ".concat(u):"请上传视频文件":"请上传图片文件",[x,u]),k=(0,s.useCallback)(async e=>{let t=N(e);if(t)return void j(t);j(null),w(!0);try{let t=await new Promise(a=>{if(!e.type.startsWith("image/"))return void a({});let t=new window.Image,l=URL.createObjectURL(e);t.onload=()=>{URL.revokeObjectURL(l),a({width:t.width,height:t.height})},t.onerror=()=>{URL.revokeObjectURL(l),a({})},t.src=l}),l=URL.createObjectURL(e),s=await new Promise((a,t)=>{let l=new FileReader;l.onload=()=>{"string"==typeof l.result?a(l.result):t(Error("转换base64失败"))},l.onerror=()=>t(Error("读取文件失败")),l.readAsDataURL(e)}),r={id:Date.now().toString(),file:e,url:l,base64:s,name:e.name,size:e.size,...t};null==a||a(r)}catch(e){console.error("文件处理失败:",e),j("文件处理失败，请重试")}finally{w(!1)}},[N,a]);return(0,l.jsxs)("div",{className:(0,d.cn)("w-full min-h-56",h),children:[m?(0,l.jsxs)("div",{className:"relative bg-[#383842] rounded-lg",children:[(0,l.jsx)(o.$,{onClick:()=>{m&&URL.revokeObjectURL(m.url),null==t||t(),j(null),w(!1)},size:"icon",variant:"ghost",className:"absolute top-2 right-2 h-8 w-8 bg-black/50 hover:bg-black/70 text-white z-10",disabled:v,children:(0,l.jsx)(r.A,{className:"w-4 h-4"})}),(0,l.jsx)("div",{className:"h-56 relative rounded-lg overflow-hidden bg-gray-700",children:m.file.type.startsWith("video/")?(0,l.jsx)("video",{src:m.url,className:"w-full h-full object-contain",controls:!0,preload:"metadata"}):(0,l.jsx)(c.default,{src:m.url,alt:m.name,fill:!0,className:"object-contain",unoptimized:!0})})]}):(0,l.jsx)("div",{className:(0,d.cn)("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors","bg-[#383842] border-[#4a4a54]",g&&"border-primary bg-primary/10",(v||y)&&"cursor-not-allowed opacity-50",!v&&!y&&"hover:border-primary"),onDragOver:e=>{e.preventDefault(),v||y||p(!0)},onDragLeave:e=>{e.preventDefault(),p(!1)},onDrop:e=>{if(e.preventDefault(),p(!1),v||y)return;let a=e.dataTransfer.files;a&&a.length>0&&k(a[0])},onClick:()=>{if(!v&&!y){var e;null==(e=b.current)||e.click()}},children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,l.jsx)("div",{className:(0,d.cn)("w-16 h-16 rounded-full flex items-center justify-center","bg-[#4a4a54]",g&&"bg-primary/20"),children:g?(0,l.jsx)(i.A,{className:"w-8 h-8 text-primary"}):(0,l.jsx)(n.A,{className:"w-8 h-8 text-gray-400"})}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("p",{className:"text-white font-medium",children:y?"video/*"===u?"正在处理视频...":"正在处理文件...":g?"video/*"===u?"松开以上传视频":"松开以上传文件":"video/*"===u?"点击上传视频":"点击上传文件"}),!y&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("p",{className:"text-sm text-gray-400",children:["或将","video/*"===u?"视频":"文件","拖拽到此处"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"video/*"===u?"支持 MP4、AVI、MOV 等格式，最大 ".concat(x,"MB"):"支持 JPG、PNG、WEBP 格式，最大 ".concat(x,"MB")})]})]})]})}),f&&(0,l.jsx)("div",{className:"mt-2 text-sm text-red-400 bg-red-500/10 border border-red-500/20 rounded-lg p-2",children:f}),(0,l.jsx)("input",{ref:b,type:"file",accept:u,onChange:e=>{let a=e.target.files;a&&a.length>0&&k(a[0]),e.target.value=""},className:"hidden",disabled:v||y})]})}},1915:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let l=(0,t(4805).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},3816:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let l=(0,t(4805).A)("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]])},3896:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let l=(0,t(4805).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},3940:(e,a,t)=>{Promise.resolve().then(t.bind(t,4923))},4360:(e,a,t)=>{"use strict";t.d(a,{T:()=>r});var l=t(8045);t(5177);var s=t(6389);function r(e){let{className:a,...t}=e;return(0,l.jsx)("textarea",{"data-slot":"textarea",className:(0,s.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...t})}},4923:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>k});var l=t(8045),s=t(5177),r=t(7694),i=t(8247),n=t(6445),d=t(1574),c=t(6686),o=t(8365),h=t(6389),u=t(2989),x=t(4360),m=t(9062),v=t(4310),b=t(8225),g=t(1682),p=t(3677),f=t(7803),j=t(7148);let y={"480P":[{value:"832*480",label:"832\xd7480",ratio:"16:9"},{value:"480*832",label:"480\xd7832",ratio:"9:16"},{value:"624*624",label:"624\xd7624",ratio:"1:1"}],"720P":[{value:"1280*720",label:"1280\xd7720",ratio:"16:9"},{value:"720*1280",label:"720\xd71280",ratio:"9:16"},{value:"960*960",label:"960\xd7960",ratio:"1:1"},{value:"1088*832",label:"1088\xd7832",ratio:"4:3"},{value:"832*1088",label:"832\xd71088",ratio:"3:4"}],"1080P":[{value:"1920*1080",label:"1920\xd71080",ratio:"16:9"},{value:"1080*1920",label:"1080\xd71920",ratio:"9:16"},{value:"1440*1440",label:"1440\xd71440",ratio:"1:1"},{value:"1632*1248",label:"1632\xd71248",ratio:"4:3"},{value:"1248*1632",label:"1248\xd71632",ratio:"3:4"}]},w=[{value:"wanx2.1-i2v-turbo",label:"通义万相2.1-turbo",description:"万相2.1极速版",icon:"/image/Group.svg",qualityLevels:["480P","720P"]},{value:"wanx2.1-i2v-plus",label:"通义万相2.1-Plus",description:"万相2.1专业版",icon:"/image/Group.svg",qualityLevels:["720P"]},{value:"wan2.2-i2v-flash",label:"通义万相2.2-Flash",description:"万相2.2极速版",icon:"/image/Group.svg",qualityLevels:["480P","720P"]},{value:"wan2.2-i2v-plus",label:"通义万相2.2-Plus",description:"万相2.2专业版",icon:"/image/Group.svg",qualityLevels:["480P","1080P"]}],N=[1,2,3,4];function k(){let[e,a]=(0,s.useState)(""),[t,k]=(0,s.useState)("wanx2.1-i2v-turbo"),[A,P]=(0,s.useState)("480P"),[L,z]=(0,s.useState)(5),[C,M]=(0,s.useState)(1),[D,S]=(0,s.useState)(null),[R,U]=(0,s.useState)(!1),[q,O]=(0,s.useState)([{id:1,src:"/demo.mp4"}]),[E,_]=(0,s.useState)(null),[F,I]=(0,s.useState)(0),{formattedDuration:W,start:$,stop:G}=(0,j.g)(),T=(0,s.useCallback)(()=>{let e=w.find(e=>e.value===t);return(null==e?void 0:e.qualityLevels)||Object.keys(y)},[t]);(0,s.useEffect)(()=>{let e=T();e.length>0&&!e.includes(A)&&P(e[0])},[t,A,T]);let B=T(),H=async()=>{if(0!==q.length)try{await (0,p.rT)(q,F)}catch(e){console.error("下载失败:",e),_("下载失败，请重试")}},V=async()=>{let a=(()=>{if(!D)return"请先上传图片文件";if(D.width&&D.height){let{width:e,height:a}=D;if(e<360||e>2e3||a<360||a>2e3)return"图片尺寸必须在".concat(360,"\xd7").concat(360,"到").concat(2e3,"\xd7").concat(2e3,"像素之间，当前尺寸：").concat(e,"\xd7").concat(a)}let a=e.trim();return a?a.length>2e3?"动作描述长度不能超过2000个字符":t?C<1||C>4?"输出数量必须在1-4之间":null:"请选择模型":"请输入动作描述"})();if(a)return void _(a);let l=w.find(e=>e.value===t);if(!l)return void _("模型配置错误");if(!D)return void _("请先上传图片文件");U(!0),$(),_(null);try{let a=await (0,f.N_)({model:l.value,prompt:e.trim(),imageUrl:D.base64,resolution:A,duration:L});if(a.success&&a.data)O([{id:Date.now(),src:a.data.output.video_url}]),I(0);else throw Error(a.error||"图生视频失败")}catch(e){_(e instanceof Error?e.message:"图生视频时发生未知错误")}finally{U(!1),G()}};return(0,l.jsxs)("div",{className:"bg-[#0D0D12] min-h-screen text-white",children:[(0,l.jsx)(r.A,{}),(0,l.jsx)(i.A,{}),(0,l.jsx)("main",{className:"ml-20 pt-14",children:(0,l.jsxs)("div",{className:"flex h-[calc(100vh-56px)] p-4 gap-4",children:[(0,l.jsxs)("div",{className:"w-[380px] bg-[#24222D] p-4 flex flex-col",children:[(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-4",children:[(0,l.jsx)("h1",{className:"text-xl",children:"图像转视频AI"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"模型"}),(0,l.jsx)(b.t,{options:w,value:t,onValueChange:k,variant:"dark",size:"lg",renderTrigger:e=>e?(0,l.jsxs)("div",{className:"flex items-center gap-3 py-1",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gray-700 flex items-center justify-center",children:(0,l.jsx)(u.default,{src:e.icon,alt:e.label,unoptimized:!0,width:24,height:24})}),(0,l.jsxs)("div",{className:"text-left",children:[(0,l.jsx)("p",{className:"text-sm text-white",children:e.label}),(0,l.jsx)("p",{className:"text-xs text-gray-400",children:e.description})]})]}):null,renderItem:e=>(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-8 h-8 rounded-md bg-gray-700 flex items-center justify-center",children:(0,l.jsx)(u.default,{src:e.icon,alt:e.label,unoptimized:!0,width:24,height:24})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-white",children:e.label}),(0,l.jsx)("p",{className:"text-xs text-gray-400",children:e.description})]})]})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"上传图片"}),(0,l.jsx)(g.D,{onImageUpload:e=>{S(e),_(null)},onImageRemove:()=>{S(null),_(null)},uploadedImage:D,disabled:R,maxSize:10,accept:"image/*"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"动作描述"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(x.T,{value:e,onChange:e=>a(e.target.value),placeholder:"描述你希望图片中的元素如何动起来...",className:"h-32 bg-[#383842] !text-xs resize-none border-none focus-visible:ring-0"}),(0,l.jsxs)("div",{className:"absolute bottom-2 right-2 text-xs text-gray-500",children:[e.length,"/",2e3]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"分辨率"}),(0,l.jsx)("div",{className:"flex gap-2",children:B.map(e=>(0,l.jsx)(m.$,{variant:A===e?"default":"outline",onClick:()=>P(e),className:(0,h.cn)("flex-1",A===e?"bg-primary hover:bg-primary/90":"bg-[#383842] border-[#4a4a54] hover:bg-[#4a4a54] hover:text-white"),children:e},e))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"视频长度"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,l.jsx)(m.$,{variant:5===L?"default":"outline",onClick:()=>z(5),className:5===L?"bg-primary hover:bg-primary/90":"bg-[#383842] border-[#4a4a54] hover:bg-[#4a4a54] hover:text-white",children:"5秒"}),(0,l.jsx)(m.$,{disabled:!0,variant:10===L?"default":"outline",onClick:()=>z(10),className:10===L?"bg-primary hover:bg-primary/90":"bg-[#383842] border-[#4a4a54] hover:bg-[#4a4a54] hover:text-white",children:"10秒"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"输出视频数量"}),(0,l.jsx)("div",{className:"grid grid-cols-4 gap-2",children:N.map(e=>(0,l.jsx)(m.$,{disabled:e>1,variant:C===e?"default":"outline",onClick:()=>M(e),className:C===e?"bg-primary hover:bg-primary/90":"bg-[#383842] border-[#4a4a54] hover:bg-[#4a4a54] hover:text-white",children:e},e))})]}),(0,l.jsxs)("div",{className:"flex justify-between text-sm text-gray-400",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("span",{children:"所需额度:"}),(0,l.jsx)(n.A,{className:"w-4 h-4"})]}),(0,l.jsxs)("span",{className:"text-white",children:[50*C," 额度"]})]})]}),E&&(0,l.jsxs)("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3 flex items-start gap-2",children:[(0,l.jsx)(d.A,{className:"w-4 h-4 text-red-400 mt-0.5 flex-shrink-0"}),(0,l.jsx)("div",{className:"text-sm text-red-400",children:E})]}),(0,l.jsx)("div",{className:"pt-4 border-t border-gray-700",children:(0,l.jsxs)(m.$,{onClick:V,disabled:!D||0===e.length||R,className:"w-full h-12 bg-primary hover:bg-primary/90 text-lg",children:[(0,l.jsx)(c.A,{className:(0,h.cn)("w-5 h-5 mr-2",R&&"animate-spin")}),R?"生成中... ".concat(W):"生成视频"]})})]}),(0,l.jsxs)("div",{className:"flex flex-col flex-1 bg-[#24222D] p-4",children:[(0,l.jsx)("div",{className:"flex justify-end mb-2",children:(0,l.jsxs)(m.$,{disabled:R,size:"sm",variant:"outline",onClick:H,className:(0,h.cn)("text-xs","bg-[#383842] border-[#4a4a54] text-white","hover:bg-[#FF3466] hover:border-[#FF3466] hover:text-white"),children:[(0,l.jsx)(o.A,{className:"w-4 h-4"}),"下载当前视频"]})}),(0,l.jsx)("div",{className:"flex-1 flex items-center justify-center min-h-0 overflow-hidden",children:(0,l.jsx)(v.s,{videos:q,className:"w-full h-full max-w-full max-h-full",onCurrentChange:e=>{I(e)},autoPlay:!0,showThumbnails:!0})})]})]})})]})}},5376:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let l=(0,t(4805).A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},6174:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let l=(0,t(4805).A)("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]])},6243:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let l=(0,t(4805).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},8227:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let l=(0,t(4805).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},8420:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let l=(0,t(4805).A)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]])},9026:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let l=(0,t(4805).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},9321:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});let l=(0,t(4805).A)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]])}},e=>{e.O(0,[174,801,110,929,986,143,358],()=>e(e.s=3940)),_N_E=e.O()}]);