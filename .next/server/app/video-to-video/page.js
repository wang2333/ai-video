(()=>{var a={};a.id=310,a.ids=[310],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},2514:(a,b,c)=>{Promise.resolve().then(c.bind(c,45287))},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},6128:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(15988).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:a=>{"use strict";a.exports=require("querystring")},18368:a=>{a.exports=function(a){"use strict";var b=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function c(a,b){var c=a[0],d=a[1],e=a[2],f=a[3];c+=(d&e|~d&f)+b[0]-0x28955b88|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[1]-0x173848aa|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[2]+0x242070db|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[3]-0x3e423112|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[4]-0xa83f051|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[5]+0x4787c62a|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[6]-0x57cfb9ed|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[7]-0x2b96aff|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[8]+0x698098d8|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[9]-0x74bb0851|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[10]-42063|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[11]-0x76a32842|0,c+=((d=(d<<22|d>>>10)+e|0)&e|~d&f)+b[12]+0x6b901122|0,f+=((c=(c<<7|c>>>25)+d|0)&d|~c&e)+b[13]-0x2678e6d|0,e+=((f=(f<<12|f>>>20)+c|0)&c|~f&d)+b[14]-0x5986bc72|0,d+=((e=(e<<17|e>>>15)+f|0)&f|~e&c)+b[15]+0x49b40821|0,c+=((d=(d<<22|d>>>10)+e|0)&f|e&~f)+b[1]-0x9e1da9e|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[6]-0x3fbf4cc0|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[11]+0x265e5a51|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[0]-0x16493856|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[5]-0x29d0efa3|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[10]+0x2441453|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[15]-0x275e197f|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[4]-0x182c0438|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[9]+0x21e1cde6|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[14]-0x3cc8f82a|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[3]-0xb2af279|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[8]+0x455a14ed|0,c+=((d=(d<<20|d>>>12)+e|0)&f|e&~f)+b[13]-0x561c16fb|0,f+=((c=(c<<5|c>>>27)+d|0)&e|d&~e)+b[2]-0x3105c08|0,e+=((f=(f<<9|f>>>23)+c|0)&d|c&~d)+b[7]+0x676f02d9|0,d+=((e=(e<<14|e>>>18)+f|0)&c|f&~c)+b[12]-0x72d5b376|0,c+=((d=(d<<20|d>>>12)+e|0)^e^f)+b[5]-378558|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[8]-0x788e097f|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[11]+0x6d9d6122|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[14]-0x21ac7f4|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[1]-0x5b4115bc|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[4]+0x4bdecfa9|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[7]-0x944b4a0|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[10]-0x41404390|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[13]+0x289b7ec6|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[0]-0x155ed806|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[3]-0x2b10cf7b|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[6]+0x4881d05|0,c+=((d=(d<<23|d>>>9)+e|0)^e^f)+b[9]-0x262b2fc7|0,f+=((c=(c<<4|c>>>28)+d|0)^d^e)+b[12]-0x1924661b|0,e+=((f=(f<<11|f>>>21)+c|0)^c^d)+b[15]+0x1fa27cf8|0,d+=((e=(e<<16|e>>>16)+f|0)^f^c)+b[2]-0x3b53a99b|0,d=(d<<23|d>>>9)+e|0,c+=(e^(d|~f))+b[0]-0xbd6ddbc|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[7]+0x432aff97|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[14]-0x546bdc59|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[5]-0x36c5fc7|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[12]+0x655b59c3|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[3]-0x70f3336e|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[10]-1051523|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[1]-0x7a7ba22f|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[8]+0x6fa87e4f|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[15]-0x1d31920|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[6]-0x5cfebcec|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[13]+0x4e0811a1|0,d=(d<<21|d>>>11)+e|0,c+=(e^(d|~f))+b[4]-0x8ac817e|0,c=(c<<6|c>>>26)+d|0,f+=(d^(c|~e))+b[11]-0x42c50dcb|0,f=(f<<10|f>>>22)+c|0,e+=(c^(f|~d))+b[2]+0x2ad7d2bb|0,e=(e<<15|e>>>17)+f|0,d+=(f^(e|~c))+b[9]-0x14792c6f|0,d=(d<<21|d>>>11)+e|0,a[0]=c+a[0]|0,a[1]=d+a[1]|0,a[2]=e+a[2]|0,a[3]=f+a[3]|0}function d(a){var b,c=[];for(b=0;b<64;b+=4)c[b>>2]=a.charCodeAt(b)+(a.charCodeAt(b+1)<<8)+(a.charCodeAt(b+2)<<16)+(a.charCodeAt(b+3)<<24);return c}function e(a){var b,c=[];for(b=0;b<64;b+=4)c[b>>2]=a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24);return c}function f(a){var b,e,f,g,h,i,j=a.length,k=[0x67452301,-0x10325477,-0x67452302,0x10325476];for(b=64;b<=j;b+=64)c(k,d(a.substring(b-64,b)));for(e=(a=a.substring(b-64)).length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;b<e;b+=1)f[b>>2]|=a.charCodeAt(b)<<(b%4<<3);if(f[b>>2]|=128<<(b%4<<3),b>55)for(c(k,f),b=0;b<16;b+=1)f[b]=0;return h=parseInt((g=(g=8*j).toString(16).match(/(.*?)(.{0,8})$/))[2],16),i=parseInt(g[1],16)||0,f[14]=h,f[15]=i,c(k,f),k}function g(a){var c;for(c=0;c<a.length;c+=1)a[c]=function(a){var c,d="";for(c=0;c<4;c+=1)d+=b[a>>8*c+4&15]+b[a>>8*c&15];return d}(a[c]);return a.join("")}function h(a){return/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a))),a}function i(a){var b,c=[],d=a.length;for(b=0;b<d-1;b+=2)c.push(parseInt(a.substr(b,2),16));return String.fromCharCode.apply(String,c)}function j(){this.reset()}return g(f("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function a(a,b){return(a=0|a||0)<0?Math.max(a+b,0):Math.min(a,b)}ArrayBuffer.prototype.slice=function(b,c){var d,e,f,g,h=this.byteLength,i=a(b,h),j=h;return(void 0!==c&&(j=a(c,h)),i>j)?new ArrayBuffer(0):(f=new Uint8Array(e=new ArrayBuffer(d=j-i)),g=new Uint8Array(this,i,d),f.set(g),e)}}(),j.prototype.append=function(a){return this.appendBinary(h(a)),this},j.prototype.appendBinary=function(a){this._buff+=a,this._length+=a.length;var b,e=this._buff.length;for(b=64;b<=e;b+=64)c(this._hash,d(this._buff.substring(b-64,b)));return this._buff=this._buff.substring(b-64),this},j.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;b<e;b+=1)f[b>>2]|=d.charCodeAt(b)<<(b%4<<3);return this._finish(f,e),c=g(this._hash),a&&(c=i(c)),this.reset(),c},j.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[0x67452301,-0x10325477,-0x67452302,0x10325476],this},j.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},j.prototype.setState=function(a){return this._buff=a.buff,this._length=a.length,this._hash=a.hash,this},j.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},j.prototype._finish=function(a,b){var d,e,f,g=b;if(a[g>>2]|=128<<(g%4<<3),g>55)for(c(this._hash,a),g=0;g<16;g+=1)a[g]=0;e=parseInt((d=(d=8*this._length).toString(16).match(/(.*?)(.{0,8})$/))[2],16),f=parseInt(d[1],16)||0,a[14]=e,a[15]=f,c(this._hash,a)},j.hash=function(a,b){return j.hashBinary(h(a),b)},j.hashBinary=function(a,b){var c=g(f(a));return b?i(c):c},j.ArrayBuffer=function(){this.reset()},j.ArrayBuffer.prototype.append=function(a){var b,d,f,g=(b=this._buff.buffer,(d=new Uint8Array(b.byteLength+a.byteLength)).set(new Uint8Array(b)),d.set(new Uint8Array(a),b.byteLength),d),h=g.length;for(this._length+=a.byteLength,f=64;f<=h;f+=64)c(this._hash,e(g.subarray(f-64,f)));return this._buff=new Uint8Array(f-64<h?g.buffer.slice(f-64):0),this},j.ArrayBuffer.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;b<e;b+=1)f[b>>2]|=d[b]<<(b%4<<3);return this._finish(f,e),c=g(this._hash),a&&(c=i(c)),this.reset(),c},j.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[0x67452301,-0x10325477,-0x67452302,0x10325476],this},j.ArrayBuffer.prototype.getState=function(){var a,b=j.prototype.getState.call(this);return a=b.buff,b.buff=String.fromCharCode.apply(null,new Uint8Array(a)),b},j.ArrayBuffer.prototype.setState=function(a){return a.buff=function(a,b){var c,d=a.length,e=new ArrayBuffer(d),f=new Uint8Array(e);for(c=0;c<d;c+=1)f[c]=a.charCodeAt(c);return b?f:e}(a.buff,!0),j.prototype.setState.call(this,a)},j.ArrayBuffer.prototype.destroy=j.prototype.destroy,j.ArrayBuffer.prototype._finish=j.prototype._finish,j.ArrayBuffer.hash=function(a,b){var d=g(function(a){var b,d,f,g,h,i,j=a.length,k=[0x67452301,-0x10325477,-0x67452302,0x10325476];for(b=64;b<=j;b+=64)c(k,e(a.subarray(b-64,b)));for(d=(a=b-64<j?a.subarray(b-64):new Uint8Array(0)).length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;b<d;b+=1)f[b>>2]|=a[b]<<(b%4<<3);if(f[b>>2]|=128<<(b%4<<3),b>55)for(c(k,f),b=0;b<16;b+=1)f[b]=0;return h=parseInt((g=(g=8*j).toString(16).match(/(.*?)(.{0,8})$/))[2],16),i=parseInt(g[1],16)||0,f[14]=h,f[15]=i,c(k,f),k}(new Uint8Array(a)));return b?i(d):d},j}()},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},28354:a=>{"use strict";a.exports=require("util")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{"use strict";a.exports=require("path")},39580:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>aM});var d,e,f=c(12076),g=c(4885),h=c(12986),i=c(43669),j=c(273),k=c(16098),l=c(26334),m=c(3417),n=c(51975),o=c(45243),p=c(89036),q=c(90342),r=c(98741),s=c(6128),t=c(50178);function u({onFileSelect:a,onVideoRemove:b,className:c="",uploadedVideo:d=null,disabled:e=!1,error:h=null,isUploading:i=!1,uploadProgress:j=null}){let k=(0,g.useRef)(null),[l,m]=(0,g.useState)(!1),o=b=>{a?.(b)};return(0,f.jsxs)("div",{className:(0,n.cn)("w-full",c),children:[d?(0,f.jsxs)("div",{className:"relative bg-[#383842] rounded-lg",children:[(0,f.jsx)(p.$,{onClick:()=>{b?.()},size:"icon",variant:"ghost",className:"absolute top-2 right-2 h-8 w-8 bg-black/50 hover:bg-black/70 text-white z-10",disabled:e,children:(0,f.jsx)(r.A,{className:"w-4 h-4"})}),(0,f.jsx)("div",{className:"h-56 relative rounded-lg overflow-hidden bg-gray-700",children:(0,f.jsx)("video",{src:d.uploadUrl||d.url,className:"w-full h-full object-contain",controls:!0,preload:"metadata"})})]}):(0,f.jsx)("div",{className:(0,n.cn)("border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors","bg-[#383842] border-[#4a4a54]",l&&"border-primary bg-primary/10",(e||i)&&"cursor-not-allowed opacity-50",!e&&!i&&"hover:border-primary"),onDragOver:a=>{a.preventDefault(),e||i||m(!0)},onDragLeave:a=>{a.preventDefault(),m(!1)},onDrop:a=>{if(a.preventDefault(),m(!1),e||i)return;let b=a.dataTransfer.files;b&&b.length>0&&o(b[0])},onClick:()=>{e||i||k.current?.click()},children:(0,f.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,f.jsx)("div",{className:(0,n.cn)("w-16 h-16 rounded-full flex items-center justify-center","bg-[#4a4a54]",l&&"bg-primary/20"),children:l?(0,f.jsx)(s.A,{className:"w-8 h-8 text-primary"}):(0,f.jsx)(t.A,{className:"w-8 h-8 text-gray-400"})}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("p",{className:"text-white font-medium",children:i?j?`上传中... ${j.percent}%`:"正在处理视频...":l?"松开以上传视频":"点击上传视频"}),!i&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("p",{className:"text-sm text-gray-400",children:"或将视频文件拖拽到此处"}),(0,f.jsx)("p",{className:"text-xs text-gray-500",children:"支持常见的视频格式"})]}),i&&j&&(0,f.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2 mt-3",children:(0,f.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${j.percent}%`}})})]})]})}),h&&(0,f.jsx)("div",{className:"mt-2 text-sm text-red-400 bg-red-500/10 border border-red-500/20 rounded-lg p-3",children:h}),(0,f.jsx)("input",{ref:k,type:"file",accept:"video/*",onChange:a=>{let b=a.target.files;b&&b.length>0&&o(b[0]),a.target.value=""},className:"hidden",disabled:e||i})]})}var v=function(){var a=function(b,c){return(a=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();!function(a){a.InvalidFile="InvalidFile",a.InvalidToken="InvalidToken",a.InvalidMetadata="InvalidMetadata",a.InvalidChunkSize="InvalidChunkSize",a.InvalidCustomVars="InvalidCustomVars",a.NotAvailableUploadHost="NotAvailableUploadHost",a.ReadCacheFailed="ReadCacheFailed",a.InvalidCacheData="InvalidCacheData",a.WriteCacheFailed="WriteCacheFailed",a.RemoveCacheFailed="RemoveCacheFailed",a.GetCanvasContextFailed="GetCanvasContextFailed",a.UnsupportedFileType="UnsupportedFileType",a.FileReaderReadFailed="FileReaderReadFailed",a.NotAvailableXMLHttpRequest="NotAvailableXMLHttpRequest",a.InvalidProgressEventTarget="InvalidProgressEventTarget",a.RequestError="RequestError"}(d||(d={}));var w=function(a,b){this.name=a,this.message=b,this.stack=Error().stack},x=function(a){function b(b,c,e,f){var g=a.call(this,d.RequestError,e)||this;return g.code=b,g.reqId=c,g.isRequestError=!0,g.data=f,g}return v(b,a),b}(w),y=function(a){function b(b,c){return void 0===c&&(c=""),a.call(this,0,c,b)||this}return v(b,a),b}(x),z=function(){function a(a,b){this.runTask=a,this.limit=b,this.aborted=!1,this.queue=[],this.processing=[]}return a.prototype.enqueue=function(a){var b=this;return new Promise(function(c,d){b.queue.push({task:a,resolve:c,reject:d}),b.check()})},a.prototype.run=function(a){var b=this;this.queue=this.queue.filter(function(b){return b!==a}),this.processing.push(a),this.runTask(a.task).then(function(){b.processing=b.processing.filter(function(b){return b!==a}),a.resolve(),b.check()},function(b){return a.reject(b)})},a.prototype.check=function(){var a=this;if(!this.aborted){var b=this.processing.length,c=this.limit-b;this.queue.slice(0,c).forEach(function(b){a.run(b)})}},a.prototype.abort=function(){this.queue=[],this.aborted=!0},a}(),A=function(){var a=function(b,c){return(a=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),B=function(){return(B=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},C=function(a){function b(b,c,d){var e=a.call(this)||this;return e.isStopped=!1,b&&"object"==typeof b?e.destination=b:e.destination=B(B(B({},b&&{next:b}),c&&{error:c}),d&&{complete:d}),e}return A(b,a),b.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,a.prototype.unsubscribe.call(this))},b.prototype.next=function(a){!this.isStopped&&this.destination.next&&this.destination.next(a)},b.prototype.error=function(a){!this.isStopped&&this.destination.error&&(this.isStopped=!0,this.destination.error(a))},b.prototype.complete=function(a){!this.isStopped&&this.destination.complete&&(this.isStopped=!0,this.destination.complete(a))},b}(function(){function a(){this.closed=!1}return a.prototype.unsubscribe=function(){!this.closed&&(this.closed=!0,this._unsubscribe&&this._unsubscribe())},a.prototype.add=function(a){this._unsubscribe=a},a}()),D=function(){function a(a){this._subscribe=a}return a.prototype.subscribe=function(a,b,c){var d=new C(a,b,c);return d.add(this._subscribe(d)),d},a}();function E(a){return(a=function(a){var b,c,d,e,f,g,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,j=0,k="",l=[];if(!a)return a;a=function(a){if(null==a)return"";var b,c,d=a+"",e="",f=0;b=c=0,f=d.length;for(var g=0;g<f;g++){var h=d.charCodeAt(g),i=null;if(h<128)c++;else if(h>127&&h<2048)i=String.fromCharCode(h>>6|192,63&h|128);else if((63488&h^55296)>0)i=String.fromCharCode(h>>12|224,h>>6&63|128,63&h|128);else{if((64512&h^55296)>0)throw RangeError("Unmatched trail surrogate at "+g);var j=d.charCodeAt(++g);if((64512&j^56320)>0)throw RangeError("Unmatched lead surrogate at "+(g-1));i=String.fromCharCode((h=((1023&h)<<10)+(1023&j)+65536)>>18|240,h>>12&63|128,h>>6&63|128,63&h|128)}null!==i&&(c>b&&(e+=d.slice(b,c)),e+=i,b=c=g+1)}return c>b&&(e+=d.slice(b,f)),e}(a+"");do b=a.charCodeAt(i++),c=(g=b<<16|a.charCodeAt(i++)<<8|a.charCodeAt(i++))>>18&63,d=g>>12&63,e=g>>6&63,f=63&g,l[j++]=h.charAt(c)+h.charAt(d)+h.charAt(e)+h.charAt(f);while(i<a.length);switch(k=l.join(""),a.length%3){case 1:k=k.slice(0,-2)+"==";break;case 2:k=k.slice(0,-1)+"="}return k}(a)).replace(/\//g,"_").replace(/\+/g,"-")}var F=c(18368),G=c.n(F),H=function(){return(H=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},I=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){var i=[f,h];if(c)throw TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&i[0]?d.return:i[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,i[1])).done)return e;switch(d=0,e&&(i=[2&i[0],e.value]),i[0]){case 0:case 1:e=i;break;case 4:return g.label++,{value:i[1],done:!1};case 5:g.label++,d=i[1],i=[0];continue;case 7:i=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===i[0]||2===i[0])){g=0;continue}if(3===i[0]&&(!e||i[1]>e[0]&&i[1]<e[3])){g.label=i[1];break}if(6===i[0]&&g.label<e[1]){g.label=e[1],e=i;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(i);break}e[2]&&g.ops.pop(),g.trys.pop();continue}i=b.call(a,g)}catch(a){i=[6,a],d=0}finally{c=e=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}};function J(a,b){try{localStorage.removeItem(a)}catch(c){b.warn(new w(d.RemoveCacheFailed,"removeLocalFileInfo failed. key: "+a))}}function K(a){return{Authorization:"UpToken "+a}}function L(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)return new window.ActiveXObject("Microsoft.XMLHTTP");throw new w(d.NotAvailableXMLHttpRequest,"the current environment does not support.")}function M(a,b){return new Promise(function(c,d){var e=L();if(e.open(b.method,a),b.onCreate&&b.onCreate(e),b.headers){var f=b.headers;Object.keys(f).forEach(function(a){e.setRequestHeader(a,f[a])})}e.upload.addEventListener("progress",function(a){a.lengthComputable&&b.onProgress&&b.onProgress({loaded:a.loaded,total:a.total})}),e.onreadystatechange=function(){var a=e.responseText;if(4===e.readyState){var b=e.getResponseHeader("x-reqId")||"";if(0===e.status)return void d(new y("network error.",b));if(200!==e.status){var f="xhr request failed, code: "+e.status;a&&(f+=" response: "+a);var g=void 0;try{g=JSON.parse(a)}catch(a){}d(new x(e.status,b,f,g));return}try{c({data:JSON.parse(a),reqId:b})}catch(a){d(a)}}},e.send(b.body)})}function N(a){if(!a)throw new w(d.InvalidToken,"invalid token.");var b,c=a.split(":");if(1===c.length)throw new w(d.InvalidToken,"invalid token segments.");var e=c.length>3?c[1]:c[0];if(!e)throw new w(d.InvalidToken,"missing assess key field.");var f=null;try{f=JSON.parse((b=c[c.length-1],function(a){var b,c,d,e,f,g,h,i,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m=[];if(!a)return a;a+="";do e=j.indexOf(a.charAt(k++)),f=j.indexOf(a.charAt(k++)),g=j.indexOf(a.charAt(k++)),b=(i=e<<18|f<<12|g<<6|(h=j.indexOf(a.charAt(k++))))>>16&255,c=i>>8&255,d=255&i,64===g?m[l++]=String.fromCharCode(b):64===h?m[l++]=String.fromCharCode(b,c):m[l++]=String.fromCharCode(b,c,d);while(k<a.length);return function(a){var b=[],c=0,d=0,e=0;for(a+="";c<a.length;){d=255&a.charCodeAt(c),e=0,d<=191?(d&=127,e=1):d<=223?(d&=31,e=2):d<=239?(d&=15,e=3):(d&=7,e=4);for(var f=1;f<e;++f)d=d<<6|63&a.charCodeAt(f+c);4===e?(d-=65536,b.push(String.fromCharCode(55296|d>>10&1023)),b.push(String.fromCharCode(56320|1023&d))):b.push(String.fromCharCode(d)),c+=e}return b.join("")}(m.join(""))}(b=b.replace(/_/g,"/").replace(/-/g,"+"))))}catch(a){throw new w(d.InvalidToken,"token parse failed.")}if(null==f)throw new w(d.InvalidToken,"putPolicy is null.");if(null==f.scope)throw new w(d.InvalidToken,"scope field is null.");var g=f.scope.split(":")[0];if(!g)throw new w(d.InvalidToken,"resolve bucketName failed.");return{assessKey:e,bucketName:g,scope:f.scope}}var O={z0:"z0",z1:"z1",z2:"z2",na0:"na0",as0:"as0",cnEast2:"cn-east-2"},P=((e={})[O.z0]={srcUphost:["up.qiniup.com"],cdnUphost:["upload.qiniup.com"]},e[O.z1]={srcUphost:["up-z1.qiniup.com"],cdnUphost:["upload-z1.qiniup.com"]},e[O.z2]={srcUphost:["up-z2.qiniup.com"],cdnUphost:["upload-z2.qiniup.com"]},e[O.na0]={srcUphost:["up-na0.qiniup.com"],cdnUphost:["upload-na0.qiniup.com"]},e[O.as0]={srcUphost:["up-as0.qiniup.com"],cdnUphost:["upload-as0.qiniup.com"]},e[O.cnEast2]={srcUphost:["up-cn-east-2.qiniup.com"],cdnUphost:["upload-cn-east-2.qiniup.com"]},e),Q=c(11723),R=function(){return(R=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},S=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){var i=[f,h];if(c)throw TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&i[0]?d.return:i[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,i[1])).done)return e;switch(d=0,e&&(i=[2&i[0],e.value]),i[0]){case 0:case 1:e=i;break;case 4:return g.label++,{value:i[1],done:!1};case 5:g.label++,d=i[1],i=[0];continue;case 7:i=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===i[0]||2===i[0])){g=0;continue}if(3===i[0]&&(!e||i[1]>e[0]&&i[1]<e[3])){g.label=i[1];break}if(6===i[0]&&g.label<e[1]){g.label=e[1],e=i;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(i);break}e[2]&&g.ops.pop(),g.trys.pop();continue}i=b.call(a,g)}catch(a){i=[6,a],d=0}finally{c=e=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}};function T(a,b,c){var d=c.url,e=c.id;return d+"/buckets/"+a+"/objects/"+(null!=b?E(b):"~")+"/uploads/"+e}var U=function(){return(U=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},V=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})},W=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){var i=[f,h];if(c)throw TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&i[0]?d.return:i[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,i[1])).done)return e;switch(d=0,e&&(i=[2&i[0],e.value]),i[0]){case 0:case 1:e=i;break;case 4:return g.label++,{value:i[1],done:!1};case 5:g.label++,d=i[1],i=[0];continue;case 7:i=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===i[0]||2===i[0])){g=0;continue}if(3===i[0]&&(!e||i[1]>e[0]&&i[1]<e[3])){g.label=i[1];break}if(6===i[0]&&g.label<e[1]){g.label=e[1],e=i;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(i);break}e[2]&&g.ops.pop(),g.trys.pop();continue}i=b.call(a,g)}catch(a){i=[6,a],d=0}finally{c=e=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}},X=function(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,e,f=c.call(a),g=[];try{for(;(void 0===b||b-- >0)&&!(d=f.next()).done;)g.push(d.value)}catch(a){e={error:a}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error}}return g},Y=[0,502,503,504,599],Z=function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(X(arguments[b]));return a}(Y,[406]),$=function(){function a(a,b,c,d){this.hostPool=c,this.logger=d,this.aborted=!1,this.retryCount=0,this.xhrList=[],this.config=a.config,d.info("config inited.",this.config),this.putExtra=U({fname:""},a.putExtra),d.info("putExtra inited.",this.putExtra),this.key=a.key,this.file=a.file,this.token=a.token,this.onData=b.onData,this.onError=b.onError,this.onComplete=b.onComplete;try{var e=N(this.token);this.bucketName=e.bucketName,this.assessKey=e.assessKey}catch(a){d.error("get putPolicy from token failed.",a),this.onError(a)}}return a.prototype.checkAndUpdateUploadHost=function(){return V(this,void 0,void 0,function(){var a;return W(this,function(b){switch(b.label){case 0:return this.logger.info("get available upload host."),[4,this.hostPool.getUp(this.assessKey,this.bucketName,this.config.upprotocol)];case 1:if(null==(a=b.sent()))throw new w(d.NotAvailableUploadHost,"no available upload host.");return null!=this.uploadHost&&this.uploadHost.host!==a.host?this.logger.warn("host switches from "+this.uploadHost.host+" to "+a.host+"."):this.logger.info("use host "+a.host+"."),this.uploadHost=a,[2]}})})},a.prototype.checkAndUnfreezeHost=function(){this.logger.info("check unfreeze host."),null!=this.uploadHost&&this.uploadHost.isFrozen()&&(this.logger.warn(this.uploadHost.host+" will be unfrozen."),this.uploadHost.unfreeze())},a.prototype.checkAndFreezeHost=function(a){this.logger.info("check freeze host."),a instanceof x&&null!=this.uploadHost&&Y.includes(a.code)&&(this.logger.warn(this.uploadHost.host+" will be temporarily frozen."),this.uploadHost.freeze())},a.prototype.handleError=function(a){this.logger.error(a.message),this.onError(a)},a.prototype.putFile=function(){return V(this,void 0,void 0,function(){var a,b,c;return W(this,function(e){switch(e.label){case 0:if(this.aborted=!1,this.putExtra.fname||(this.logger.info("use file.name as fname."),this.putExtra.fname=this.file.name),this.file.size>1073741824e4)return this.handleError(new w(d.InvalidFile,"file size exceed maximum value 10000G")),[2];if(this.putExtra.customVars&&!Object.keys(this.putExtra.customVars).every(function(a){return 0===a.indexOf("x:")}))return this.handleError(new w(d.InvalidCustomVars,"customVars key should start width x:")),[2];if(this.putExtra.metadata&&!Object.keys(this.putExtra.metadata).every(function(a){return 0===a.indexOf("x-qn-meta-")}))return this.handleError(new w(d.InvalidMetadata,"metadata key should start with x-qn-meta-")),[2];e.label=1;case 1:return e.trys.push([1,4,,5]),this.uploadAt=new Date().getTime(),[4,this.checkAndUpdateUploadHost()];case 2:return e.sent(),[4,this.run()];case 3:return a=e.sent(),this.onComplete(a.data),this.checkAndUnfreezeHost(),this.sendLog(a.reqId,200),[2];case 4:if(b=e.sent(),this.aborted)return this.logger.warn("upload is aborted."),this.sendLog("",-2),[2];if(this.clear(),this.logger.error(b),b instanceof x&&(this.sendLog(b.reqId,b.code),this.checkAndFreezeHost(b),c=++this.retryCount<=this.config.retryCount,Z.includes(b.code)&&c))return this.logger.warn("error auto retry: "+this.retryCount+"/"+this.config.retryCount+"."),this.putFile(),[2];return this.onError(b),[3,5];case 5:return[2]}})})},a.prototype.clear=function(){this.xhrList.forEach(function(a){a.onreadystatechange=null,a.abort()}),this.xhrList=[],this.logger.info("cleanup uploading xhr.")},a.prototype.stop=function(){this.logger.info("aborted."),this.clear(),this.aborted=!0},a.prototype.addXhr=function(a){this.xhrList.push(a)},a.prototype.sendLog=function(a,b){var c,d;this.logger.report({code:b,reqId:a,remoteIp:"",upType:"jssdk-h5",size:this.file.size,time:Math.floor(this.uploadAt/1e3),port:function(a){if(a&&a.match){var b=a.match(/(^https?)/);if(!b)return"";var c=b[1];return(b=a.match(/^https?:\/\/([^:^/]*):(\d*)/))?b[2]:"http"===c?"80":"443"}return""}(null==(c=this.uploadHost)?void 0:c.getUrl()),host:function(a){if(a&&a.match){var b=a.match(/^https?:\/\/([^:^/]*)/);return b?b[1]:""}return""}(null==(d=this.uploadHost)?void 0:d.getUrl()),bytesSent:this.progress?this.progress.total.loaded:0,duration:Math.floor((new Date().getTime()-this.uploadAt)/1e3)})},a.prototype.getProgressInfoItem=function(a,b,c){return U({size:b,loaded:a,percent:a/b*100},null==c?{}:{fromCache:c})},a}(),_=function(){var a=function(b,c){return(a=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),aa=function(){return(aa=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},ab=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})},ac=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){var i=[f,h];if(c)throw TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&i[0]?d.return:i[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,i[1])).done)return e;switch(d=0,e&&(i=[2&i[0],e.value]),i[0]){case 0:case 1:e=i;break;case 4:return g.label++,{value:i[1],done:!1};case 5:g.label++,d=i[1],i=[0];continue;case 7:i=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===i[0]||2===i[0])){g=0;continue}if(3===i[0]&&(!e||i[1]>e[0]&&i[1]<e[3])){g.label=i[1];break}if(6===i[0]&&g.label<e[1]){g.label=e[1],e=i;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(i);break}e[2]&&g.ops.pop(),g.trys.pop();continue}i=b.call(a,g)}catch(a){i=[6,a],d=0}finally{c=e=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}},ad=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return _(b,a),b.prototype.run=function(){return ab(this,void 0,void 0,function(){var a,b,c,e,f,g=this;return ac(this,function(h){switch(h.label){case 0:var i;if(this.logger.info("start run Resume."),!this.config.chunkSize||(i=this.config.chunkSize,!/^[1-9]\d*$/.test(String(i))))throw new w(d.InvalidChunkSize,"chunkSize must be a positive integer");if(this.config.chunkSize>1024)throw new w(d.InvalidChunkSize,"chunkSize maximum value is 1024");return[4,this.initBeforeUploadChunks()];case 1:h.sent(),a=new z(function(b){return ab(g,void 0,void 0,function(){return ac(this,function(c){switch(c.label){case 0:if(this.aborted)throw a.abort(),Error("pool is aborted");return[4,this.uploadChunk(b)];case 1:return c.sent(),[2]}})})},this.config.concurrentRequestLimit),b=null,c=this.getLocalKey(),e=this.chunks.map(function(b,c){return a.enqueue({chunk:b,index:c})}),h.label=2;case 2:return h.trys.push([2,5,,6]),[4,Promise.all(e)];case 3:return h.sent(),[4,this.mkFileReq()];case 4:return b=h.sent(),[3,6];case 5:throw(f=h.sent())instanceof x&&(612===f.code||400===f.code)&&J(c,this.logger),f;case 6:return J(c,this.logger),[2,b]}})})},b.prototype.uploadChunk=function(a){return ab(this,void 0,void 0,function(){var b,c,e,f,g,h,i,j,k,l=this;return ac(this,function(m){switch(m.label){case 0:if(b=a.index,c=a.chunk,e=this.cachedUploadedList[b],this.logger.info("upload part "+b+", cache:",e),f=this.config.checkByMD5,g=function(){l.usedCacheList[b]=!0,l.updateChunkProgress(c.size,b),l.uploadedList[b]=e,l.updateLocalCache()},e&&!f)return g(),[2];return[4,function(a){var b,c,e,f;return b=this,c=void 0,e=void 0,f=function(){var b,c;return I(this,function(e){switch(e.label){case 0:var f;return[4,(f=a,new Promise(function(a,b){var c=new FileReader;c.onload=function(c){c.target?a(c.target.result):b(new w(d.InvalidProgressEventTarget,"progress event target is undefined"))},c.onerror=function(){b(new w(d.FileReaderReadFailed,"fileReader read failed"))},c.readAsArrayBuffer(f)}))];case 1:return b=e.sent(),(c=new(G()).ArrayBuffer).append(b),[2,c.end()]}})},new(e||(e=Promise))(function(a,d){function g(a){try{i(f.next(a))}catch(a){d(a)}}function h(a){try{i(f.throw(a))}catch(a){d(a)}}function i(b){var c;b.done?a(b.value):((c=b.value)instanceof e?c:new e(function(a){a(c)})).then(g,h)}i((f=f.apply(b,c||[])).next())})}(c)];case 1:var n,o,p,q,r,s,t,u;if(h=m.sent(),this.logger.info("computed part md5.",h),e&&h===e.md5)return g(),[2];return this.usedCacheList[b]=!1,i=function(a){l.updateChunkProgress(a.loaded,b)},j={body:c,md5:this.config.checkByServer?h:void 0,onProgress:i,onCreate:function(a){return l.addXhr(a)}},this.logger.info("part "+b+" start uploading."),[4,(n=this.token,o=this.key,p=a.index+1,q=this.getUploadInfo(),r=j,t=T(N(n).bucketName,o,q)+"/"+p,u=(s=K(n),H({"content-type":"application/octet-stream"},s)),r.md5&&(u["Content-MD5"]=r.md5),M(t,R(R({},r),{method:"PUT",headers:u})))];case 2:return k=m.sent(),this.logger.info("part "+b+" upload completed."),i({loaded:c.size,total:c.size}),this.uploadedList[b]={etag:k.data.etag,md5:k.data.md5,size:c.size},this.updateLocalCache(),[2]}})})},b.prototype.mkFileReq=function(){return ab(this,void 0,void 0,function(){var a,b,c=this;return ac(this,function(d){switch(d.label){case 0:var e,f,g,h,i;return a=aa(aa(aa({parts:this.uploadedList.map(function(a,b){return{etag:a.etag,partNumber:b+1}}),fname:this.putExtra.fname},this.putExtra.mimeType&&{mimeType:this.putExtra.mimeType}),this.putExtra.customVars&&{customVars:this.putExtra.customVars}),this.putExtra.metadata&&{metadata:this.putExtra.metadata}),this.logger.info("parts upload completed, make file.",a),[4,(e=this.token,f=this.key,g=this.getUploadInfo(),h={onCreate:function(a){return c.addXhr(a)},body:JSON.stringify(a)},M(T(N(e).bucketName,f,g),R(R({},h),{method:"POST",headers:(i=K(e),H({"content-type":"application/json"},i))})))];case 1:return b=d.sent(),this.logger.info("finish Resume Progress."),this.updateMkFileProgress(1),[2,b]}})})},b.prototype.initBeforeUploadChunks=function(){return ab(this,void 0,void 0,function(){var a,b,c;return ac(this,function(e){switch(e.label){case 0:var f,g,h;if(this.uploadedList=[],this.usedCacheList=[],a=function(a,b){var c=null;try{c=localStorage.getItem(a)}catch(c){b.warn(new w(d.ReadCacheFailed,"getLocalFileInfo failed. key: "+a))}if(null==c)return null;var e=null;try{e=JSON.parse(c)}catch(c){J(a,b),b.warn(new w(d.InvalidCacheData,"getLocalFileInfo failed to parse. key: "+a))}return e}(this.getLocalKey(),this.logger))return[3,2];return this.logger.info("init upload parts from api."),[4,(f=this.token,g=this.bucketName,h=this.key,M(this.uploadHost.getUrl()+"/buckets/"+g+"/objects/"+(null!=h?E(h):"~")+"/uploads",{method:"POST",headers:K(f)}))];case 1:return b=e.sent(),this.logger.info("initd upload parts of id: "+b.data.uploadId+"."),this.uploadId=b.data.uploadId,this.cachedUploadedList=[],[3,3];case 2:c=["resume upload parts from local cache,","total "+a.data.length+" part,","id is "+a.id+"."],this.logger.info(c.join(" ")),this.cachedUploadedList=a.data,this.uploadId=a.id,e.label=3;case 3:return this.chunks=function(a,b){var c=1048576*b;if(c>a.size)c=a.size;else for(;a.size>1e4*c;)c*=2;for(var d=[],e=Math.ceil(a.size/c),f=0;f<e;f++){var g=a.slice(c*f,f===e-1?a.size:c*(f+1));d.push(g)}return d}(this.file,this.config.chunkSize),this.loaded={mkFileProgress:0,chunks:this.chunks.map(function(a){return 0})},this.notifyResumeProgress(),[2]}})})},b.prototype.getUploadInfo=function(){return{id:this.uploadId,url:this.uploadHost.getUrl()}},b.prototype.getLocalKey=function(){var a,b;return a=this.file.name,"qiniu_js_sdk_upload_file_name_"+a+(null==(b=this.key)?"_":"_key_"+b+"_")+"size_"+this.file.size},b.prototype.updateLocalCache=function(){!function(a,b,c){try{localStorage.setItem(a,JSON.stringify(b))}catch(b){c.warn(new w(d.WriteCacheFailed,"setLocalFileInfo failed: "+a))}}(this.getLocalKey(),{id:this.uploadId,data:this.uploadedList},this.logger)},b.prototype.updateChunkProgress=function(a,b){this.loaded.chunks[b]=a,this.notifyResumeProgress()},b.prototype.updateMkFileProgress=function(a){this.loaded.mkFileProgress=a,this.notifyResumeProgress()},b.prototype.notifyResumeProgress=function(){var a=this;this.progress={total:this.getProgressInfoItem(this.loaded.chunks.reduce(function(a,b){return a+b},0)+this.loaded.mkFileProgress,this.file.size+1),chunks:this.chunks.map(function(b,c){var d=a.usedCacheList[c];return a.getProgressInfoItem(a.loaded.chunks[c],b.size,d)}),uploadInfo:{id:this.uploadId,url:this.uploadHost.getUrl()}},this.onData(this.progress)},b}($),ae=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})},af=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){var i=[f,h];if(c)throw TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&i[0]?d.return:i[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,i[1])).done)return e;switch(d=0,e&&(i=[2&i[0],e.value]),i[0]){case 0:case 1:e=i;break;case 4:return g.label++,{value:i[1],done:!1};case 5:g.label++,d=i[1],i=[0];continue;case 7:i=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===i[0]||2===i[0])){g=0;continue}if(3===i[0]&&(!e||i[1]>e[0]&&i[1]<e[3])){g.label=i[1];break}if(6===i[0]&&g.label<e[1]){g.label=e[1],e=i;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(i);break}e[2]&&g.ops.pop(),g.trys.pop();continue}i=b.call(a,g)}catch(a){i=[6,a],d=0}finally{c=e=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}},ag=function(){function a(){this.crc=-1,this.table=this.makeTable()}return a.prototype.makeTable=function(){for(var a=[],b=0;b<256;b++){for(var c=b,d=0;d<8;d++)1&c?c=c>>>1^0xedb88320:c>>>=1;a[b]=c}return a},a.prototype.append=function(a){for(var b=this.crc,c=0;c<a.byteLength;c++)b=b>>>8^this.table[(b^a[c])&255];this.crc=b},a.prototype.compute=function(){return(-1^this.crc)>>>0},a.prototype.readAsUint8Array=function(a){return ae(this,void 0,void 0,function(){var b;return af(this,function(c){switch(c.label){case 0:if("function"!=typeof a.arrayBuffer)return[3,2];return b=Uint8Array.bind,[4,a.arrayBuffer()];case 1:return[2,new(b.apply(Uint8Array,[void 0,c.sent()]))];case 2:return[2,new Promise(function(b,c){var d=new FileReader;d.onload=function(){if(null==d.result||"string"==typeof d.result)return void c();b(new Uint8Array(d.result))},d.readAsArrayBuffer(a)})]}})})},a.prototype.file=function(a){return ae(this,void 0,void 0,function(){var b,c,d,e,f,g;return af(this,function(h){switch(h.label){case 0:if(!(a.size<=1048576))return[3,2];return b=this.append,[4,this.readAsUint8Array(a)];case 1:return b.apply(this,[h.sent()]),[2,this.compute()];case 2:c=Math.ceil(a.size/1048576),d=0,h.label=3;case 3:if(!(d<c))return[3,6];return e=1048576*d,f=d===c-1?a.size:e+1048576,[4,this.readAsUint8Array(a.slice(e,f))];case 4:g=h.sent(),this.append(new Uint8Array(g)),h.label=5;case 5:return d++,[3,3];case 6:return[2,this.compute()]}})})},a.file=function(b){return new a().file(b)},a}(),ah=function(){var a=function(b,c){return(a=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),ai=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){var i=[f,h];if(c)throw TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&i[0]?d.return:i[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,i[1])).done)return e;switch(d=0,e&&(i=[2&i[0],e.value]),i[0]){case 0:case 1:e=i;break;case 4:return g.label++,{value:i[1],done:!1};case 5:g.label++,d=i[1],i=[0];continue;case 7:i=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===i[0]||2===i[0])){g=0;continue}if(3===i[0]&&(!e||i[1]>e[0]&&i[1]<e[3])){g.label=i[1];break}if(6===i[0]&&g.label<e[1]){g.label=e[1],e=i;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(i);break}e[2]&&g.ops.pop(),g.trys.pop();continue}i=b.call(a,g)}catch(a){i=[6,a],d=0}finally{c=e=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}},aj=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return ah(b,a),b.prototype.run=function(){var a,b,c,d;return a=this,b=void 0,c=void 0,d=function(){var a,b,c,d,e,f=this;return ai(this,function(g){switch(g.label){case 0:if(this.logger.info("start run Direct."),(a=new FormData).append("file",this.file),a.append("token",this.token),null!=this.key&&a.append("key",this.key),a.append("fname",this.putExtra.fname),!this.config.checkByServer)return[3,2];return[4,ag.file(this.file)];case 1:b=g.sent(),a.append("crc32",b.toString()),g.label=2;case 2:return this.putExtra.customVars&&(this.logger.info("init customVars."),Object.keys(c=this.putExtra.customVars).forEach(function(b){return a.append(b,c[b].toString())}),this.logger.info("customVars inited.")),this.putExtra.metadata&&(this.logger.info("init metadata."),Object.keys(d=this.putExtra.metadata).forEach(function(b){return a.append(b,d[b].toString())})),this.logger.info("formData inited."),[4,M(this.uploadHost.getUrl(),R({method:"POST",body:a},{onProgress:function(a){f.updateDirectProgress(a.loaded,a.total)},onCreate:function(a){return f.addXhr(a)}}))];case 3:return e=g.sent(),this.logger.info("Direct progress finish."),this.finishDirectProgress(),[2,e]}})},new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})},b.prototype.updateDirectProgress=function(a,b){this.progress={total:this.getProgressInfoItem(a,b+1)},this.onData(this.progress)},b.prototype.finishDirectProgress=function(){if(!this.progress){this.logger.warn("progress is null."),this.progress={total:this.getProgressInfoItem(this.file.size,this.file.size)},this.onData(this.progress);return}var a=this.progress.total;this.progress={total:this.getProgressInfoItem(a.loaded+1,a.size)},this.onData(this.progress)},b}($),ak=function(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,e,f=c.call(a),g=[];try{for(;(void 0===b||b-- >0)&&!(d=f.next()).done;)g.push(d.value)}catch(a){e={error:a}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error}}return g},al=function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(ak(arguments[b]));return a},am=function(){function a(b,c,d,e){void 0===c&&(c=!0),void 0===d&&(d="OFF"),void 0===e&&(e="UPLOAD"),this.token=b,this.disableReport=c,this.level=d,this.prefix=e,this.id=++a.id}return a.prototype.getPrintPrefix=function(a){return"Qiniu-JS-SDK ["+a+"]["+this.prefix+"#"+this.id+"]:"},a.prototype.report=function(a,b){if(!this.disableReport)try{!function a(b,c,d){void 0===d&&(d=3);var e=L();e.open("POST","https://uplog.qbox.me/log/3"),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.setRequestHeader("Authorization",K(b).Authorization),e.onreadystatechange=function(){4===e.readyState&&200!==e.status&&d>0&&a(b,c,d-1)};var f=[c.code||"",c.reqId||"",c.host||"",c.remoteIp||"",c.port||"",c.duration||"",c.time||"",c.bytesSent||"",c.upType||"",c.size||""].join(",");e.send(f)}(this.token,a,b)}catch(a){this.warn(a)}},a.prototype.info=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];["INFO"].includes(this.level)&&console.log.apply(console,al([this.getPrintPrefix("INFO")],a))},a.prototype.warn=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];["INFO","WARN"].includes(this.level)&&console.warn.apply(console,al([this.getPrintPrefix("WARN")],a))},a.prototype.error=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];["INFO","WARN","ERROR"].includes(this.level)&&console.error.apply(console,al([this.getPrintPrefix("ERROR")],a))},a.id=0,a}(),an=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})},ao=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){var i=[f,h];if(c)throw TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&i[0]?d.return:i[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,i[1])).done)return e;switch(d=0,e&&(i=[2&i[0],e.value]),i[0]){case 0:case 1:e=i;break;case 4:return g.label++,{value:i[1],done:!1};case 5:g.label++,d=i[1],i=[0];continue;case 7:i=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===i[0]||2===i[0])){g=0;continue}if(3===i[0]&&(!e||i[1]>e[0]&&i[1]<e[3])){g.label=i[1];break}if(6===i[0]&&g.label<e[1]){g.label=e[1],e=i;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(i);break}e[2]&&g.ops.pop(),g.trys.pop();continue}i=b.call(a,g)}catch(a){i=[6,a],d=0}finally{c=e=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}},ap=function(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,e,f=c.call(a),g=[];try{for(;(void 0===b||b-- >0)&&!(d=f.next()).done;)g.push(d.value)}catch(a){e={error:a}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error}}return g},aq=function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(ap(arguments[b]));return a},ar=new Map,as=function(){function a(a,b){this.host=a,this.protocol=b}return a.prototype.isFrozen=function(){var a=new Date().getTime(),b=ar.get(this.host);return null!=b&&b>=a},a.prototype.freeze=function(a){void 0===a&&(a=20);var b=new Date().getTime()+1e3*a;ar.set(this.host,b)},a.prototype.unfreeze=function(){ar.delete(this.host)},a.prototype.getUrl=function(){return this.protocol+"://"+this.host},a.prototype.getUnfreezeTime=function(){return ar.get(this.host)},a}(),at=function(){function a(a){void 0===a&&(a=[]),this.initHosts=a,this.cachedHostsMap=new Map}return a.prototype.register=function(a,b,c,d){this.cachedHostsMap.set(a+"@"+b,c.map(function(a){return new as(a,d)}))},a.prototype.refresh=function(a,b,c){var d,e,f,g;return an(this,void 0,void 0,function(){var h,i;return ao(this,function(j){switch(j.label){case 0:if((this.cachedHostsMap.get(a+"@"+b)||[]).length>0)return[2];if(this.initHosts.length>0)return this.register(a,b,this.initHosts,c),[2];return[4,function(a,b,c){var d,e,f,g;return d=this,e=void 0,f=void 0,g=function(){return S(this,function(d){return[2,M(c+"://api.qiniu.com/v2/query?"+(0,Q.stringify)({ak:a,bucket:b}),{method:"GET"})]})},new(f||(f=Promise))(function(a,b){function c(a){try{i(g.next(a))}catch(a){b(a)}}function h(a){try{i(g.throw(a))}catch(a){b(a)}}function i(b){var d;b.done?a(b.value):((d=b.value)instanceof f?d:new f(function(a){a(d)})).then(c,h)}i((g=g.apply(d,e||[])).next())})}(a,b,c)];case 1:return(null==(h=j.sent())?void 0:h.data)!=null&&(i=aq((null==(e=null==(d=h.data.up)?void 0:d.acc)?void 0:e.main)||[],(null==(g=null==(f=h.data.up)?void 0:f.acc)?void 0:g.backup)||[]),this.register(a,b,i,c)),[2]}})})},a.prototype.getUp=function(a,b,c){return an(this,void 0,void 0,function(){var d,e;return ao(this,function(f){switch(f.label){case 0:return[4,this.refresh(a,b,c)];case 1:if(f.sent(),0===(d=this.cachedHostsMap.get(a+"@"+b)||[]).length)return[2,null];if((e=d.filter(function(a){return!a.isFrozen()})).length>0)return[2,e[0]];return[2,d.slice().sort(function(a,b){return(a.getUnfreezeTime()||0)-(b.getUnfreezeTime()||0)})[0]]}})})},a}(),au=function(){return(au=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},av=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c},aw=function(a,b){var c="function"==typeof Symbol&&a[Symbol.iterator];if(!c)return a;var d,e,f=c.call(a),g=[];try{for(;(void 0===b||b-- >0)&&!(d=f.next()).done;)g.push(d.value)}catch(a){e={error:a}}finally{try{d&&!d.done&&(c=f.return)&&c.call(f)}finally{if(e)throw e.error}}return g},ax=function(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(aw(arguments[b]));return a},ay=function(){return(ay=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},az=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})},aA=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){var i=[f,h];if(c)throw TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&i[0]?d.return:i[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,i[1])).done)return e;switch(d=0,e&&(i=[2&i[0],e.value]),i[0]){case 0:case 1:e=i;break;case 4:return g.label++,{value:i[1],done:!1};case 5:g.label++,d=i[1],i=[0];continue;case 7:i=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(6===i[0]||2===i[0])){g=0;continue}if(3===i[0]&&(!e||i[1]>e[0]&&i[1]<e[3])){g.label=i[1];break}if(6===i[0]&&g.label<e[1]){g.label=e[1],e=i;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(i);break}e[2]&&g.ops.pop(),g.trys.pop();continue}i=b.call(a,g)}catch(a){i=[6,a],d=0}finally{c=e=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}},aB={PNG:"image/png",JPEG:"image/jpeg",WEBP:"image/webp",BMP:"image/bmp"},aC=Math.log(2),aD=Object.keys(aB).map(function(a){return aB[a]}),aE=aB.JPEG;!function(){function a(a,b){this.file=a,this.config=b,this.config=ay({quality:.92,noCompressIfLarger:!1},this.config)}a.prototype.process=function(){return az(this,void 0,void 0,function(){var a,b,c,e,f,g;return aA(this,function(h){switch(h.label){case 0:var i;if(this.outputType=this.file.type,a={},i=this.file.type,!aD.includes(i))throw new w(d.UnsupportedFileType,"unsupported file type: "+this.file.type);return[4,this.getOriginImage()];case 1:return b=h.sent(),[4,this.getCanvas(b)];case 2:return c=h.sent(),e=1,this.config.maxWidth&&(e=Math.min(1,this.config.maxWidth/c.width)),this.config.maxHeight&&(e=Math.min(1,e,this.config.maxHeight/c.height)),a.width=c.width,a.height=c.height,[4,this.doScale(c,e)];case 3:if(f=h.sent(),(g=this.toBlob(f)).size>this.file.size&&this.config.noCompressIfLarger)return[2,{dist:this.file,width:a.width,height:a.height}];return[2,{dist:g,width:f.width,height:f.height}]}})})},a.prototype.clear=function(a,b,c){this.outputType===aE?(a.fillStyle="#fff",a.fillRect(0,0,b,c)):a.clearRect(0,0,b,c)},a.prototype.getOriginImage=function(){var a=this;return new Promise(function(b,c){var d,e=(d=a.file,(window.URL||window.webkitURL||window.mozURL).createObjectURL(d)),f=new Image;f.onload=function(){b(f)},f.onerror=function(){c("image load error")},f.src=e})},a.prototype.getCanvas=function(a){var b=this;return new Promise(function(c,e){var f=document.createElement("canvas"),g=f.getContext("2d");if(!g)return void e(new w(d.GetCanvasContextFailed,"context is null"));var h=a.width,i=a.height;f.height=i,f.width=h,b.clear(g,h,i),g.drawImage(a,0,0),c(f)})},a.prototype.doScale=function(a,b){return az(this,void 0,void 0,function(){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;return aA(this,function(t){if(1===b)return[2,a];if(c=a.getContext("2d"),e=Math.min(4,Math.ceil(1/b/aC)),f=Math.pow(b,1/e),h=(g=document.createElement("canvas")).getContext("2d"),i=a.width,j=a.height,k=i,l=j,g.width=i,g.height=j,!h||!c)throw new w(d.GetCanvasContextFailed,"mctx or sctx can't be null");for(o=0;o<e;o++)p=i*f|0,q=j*f|0,o===e-1&&(p=k*b,q=l*b),o%2==0?(m=a,n=h):(m=g,n=c),this.clear(n,i,j),n.drawImage(m,0,0,i,j,0,0,p,q),i=p,j=q;return r=m===a?g:a,s=n.getImageData(0,0,i,j),r.width=i,r.height=j,n.putImageData(s,0,0),[2,r]})})},a.prototype.toBlob=function(a){return new Blob([new Uint8Array(atob(a.toDataURL(this.outputType,this.config.quality).split(",")[1]).split("").map(function(a){return a.charCodeAt(0)}))],{type:this.outputType})}}();var aF=c(85139),aG=c(18091),aH=c(14858),aI=c(92432);let aJ=[{id:0,name:"日式漫画",description:"日本动漫风格，线条清晰，色彩鲜艳",image:"/image/style1.jpg"},{id:1,name:"美式漫画",description:"美国漫画风格，色彩饱和，线条粗犷",image:"/image/style2.jpg"},{id:2,name:"清新漫画",description:"清新淡雅的漫画风格，色调柔和",image:"/image/style3.jpg"},{id:3,name:"3D卡通",description:"三维卡通风格，立体感强",image:"/image/style4.jpg"},{id:4,name:"国风卡通",description:"中国风卡通，传统文化元素",image:"/image/style5.jpg"},{id:5,name:"纸艺风格",description:"纸艺剪纸风格，层次分明",image:"/image/style6.jpg"},{id:6,name:"简易插画",description:"简约插画风格，线条简洁",image:"/image/style7.jpg"},{id:7,name:"国风水墨",description:"中国水墨画风格，意境深远",image:"/image/style8.jpg"}],aK=[{value:"video-style-transform",label:"通义万相",description:"视频风格重绘",icon:"/image/Group.svg"}],aL=[{value:15,label:"15 FPS",description:"标准帧率"},{value:20,label:"20 FPS",description:"电影级帧率"},{value:25,label:"25 FPS",description:"高帧率"}];function aM(){let{uploadedVideo:a,isUploading:b,error:c,uploadProgress:d,handleFileSelect:e,removeVideo:r}=function(a={}){let[b,c]=(0,g.useState)(null),[d,e]=(0,g.useState)(!1),[f,h]=(0,g.useState)(null),[i,j]=(0,g.useState)(null),k=(0,g.useCallback)(a=>a.type.startsWith("video/")?a.size>524288e3?"文件大小不能超过500MB":null:"请选择视频文件",[]),l=(0,g.useCallback)(a=>new Promise((b,c)=>{let d=document.createElement("video"),e=URL.createObjectURL(a);d.onloadedmetadata=()=>{URL.revokeObjectURL(e),b({width:d.videoWidth,height:d.videoHeight,duration:d.duration})},d.onerror=()=>{URL.revokeObjectURL(e),c(Error("无法读取视频信息"))},d.src=e}),[]),m=(0,g.useCallback)(async()=>{let a=await fetch("/api/qiniu/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!a.ok)throw Error(`获取上传凭证失败: ${a.status}`);let b=await a.json();if(!b.success)throw Error(b.error||"获取上传凭证失败");return b.data},[]),n=(0,g.useCallback)((a,b)=>{let c;if(!a||!b)throw Error("域名或文件key缺失");return c=a.startsWith("http")?a:a.includes("clouddn.com")||a.includes("qiniudn.com")||a.includes("bkt.clouddn.com")?`http://${a}`:`https://${a}`,`${c}/${b}`},[]),o=(0,g.useCallback)(async b=>{let{token:c,key:d,domain:e,zone:f}=await m(),g={fname:b.name,params:{"x:name":b.name}},h={useCdnDomain:!0,region:(a=>{switch(a){case"z0":return O.z0;case"z1":return O.z1;case"z2":default:return O.z2;case"na0":return O.na0;case"as0":return O.as0}})(f||"z2")};return new Promise((f,i)=>{var k,l,m;(k=new am(c,null==h?void 0:h.disableStatisticsReport,null==h?void 0:h.debugLogLevel,b.name),m=new at((l={file:b,key:d,token:c,putExtra:g,config:function(a,b){var c=au({},a),d=c.upprotocol,e=c.uphost,f=av(c,["upprotocol","uphost"]),g=au({uphost:[],retryCount:3,checkByMD5:!1,forceDirect:!1,useCdnDomain:!0,checkByServer:!0,concurrentRequestLimit:3,chunkSize:4,upprotocol:"https",debugLogLevel:"OFF",disableStatisticsReport:!1},f);d&&(g.upprotocol=d.replace(/:$/,""));var h=[];if(b&&(null==a?void 0:a.uphost)!=null&&(null==a?void 0:a.region)!=null&&b.warn("do not use both the uphost and region config."),e)Array.isArray(e)?h.push.apply(h,ax(e)):h.push(e);else if(null==g?void 0:g.region){var i=P[null==g?void 0:g.region];g.useCdnDomain?h.push.apply(h,ax(i.cdnUphost)):h.push.apply(h,ax(i.srcUphost))}return au(au({},g),{uphost:h.filter(Boolean)})}(h,k)}).config.uphost),new D(function(a){var b,c=(b={onData:function(b){return a.next(b)},onError:function(b){return a.error(b)},onComplete:function(b){return a.complete(b)}},l.config&&l.config.forceDirect?(k.info("ues forceDirect mode."),new aj(l,b,m,k)):l.file.size>4194304?(k.info("file size over 4M, use Resume."),new ad(l,b,m,k)):(k.info("file size less or equal than 4M, use Direct."),new aj(l,b,m,k)));return c.putFile(),c.stop.bind(c)})).subscribe({next:b=>{if(b.total){let c={loaded:b.total.loaded,total:b.total.size,percent:Math.round(b.total.loaded/b.total.size*100)};j(c),a.onProgress?.(c)}},error:a=>{i(Error(a?.message||a?.err||"上传失败"))},complete:a=>{try{let b=n(e,a.key);f(b)}catch(a){i(a)}}})})},[m,n,a]),p=(0,g.useCallback)(async b=>{let d=k(b);if(d)return void h(d);h(null),e(!0),j(null);try{let d=await l(b),e=URL.createObjectURL(b),f=await o(b),g={id:Date.now().toString(),file:b,url:e,name:b.name,size:b.size,duration:d.duration,width:d.width,height:d.height,uploadUrl:f};c(g),a.onSuccess?.(f)}catch(c){let b=c instanceof Error?c.message:"上传失败，请重试";h(b),a.onError?.(b)}finally{e(!1),j(null)}},[k,l,o,a]),q=(0,g.useCallback)(()=>{b&&URL.revokeObjectURL(b.url),c(null),h(null),j(null)},[b]);return{uploadedVideo:b,isUploading:d,error:f,uploadProgress:i,handleFileSelect:p,removeVideo:q}}({onSuccess:a=>{console.log("视频上传成功:",a)},onError:a=>{console.error("视频上传失败:",a)}}),{formattedDuration:s,isRunning:t,start:v,stop:w,reset:x}=(0,aI.g)(),[y,z]=(0,g.useState)("video-style-transform"),[A,B]=(0,g.useState)(0),[C,E]=(0,g.useState)(15),[F,G]=(0,g.useState)(!1),[H,I]=(0,g.useState)([{id:1,src:"/demo.mp4"}]),[J,K]=(0,g.useState)(null),[L,M]=(0,g.useState)(0),N=["mp4","avi","mkv","mov","flv","ts","mpg","mxf"],Q=async b=>{if(K(null),await e(b),a){let b=(a=>{let b=a.name.split(".").pop()?.toLowerCase();if(!b||!N.includes(b))return`不支持的视频格式。支持格式：${N.join(", ")}`;let c=a.size/1048576;if(c>100)return`文件大小不能超过100MB，当前大小：${c.toFixed(2)}MB`;if(a.width&&a.height){if(a.width<256||a.height<256)return`视频分辨率过小。最小尺寸：256\xd7256，当前尺寸：${a.width}\xd7${a.height}`;if(a.width>4096||a.height>4096)return`视频分辨率过大。最大尺寸：4096\xd74096，当前尺寸：${a.width}\xd7${a.height}`;let b=Math.max(a.width,a.height)/Math.min(a.width,a.height);if(b>1.8)return`视频长宽比超出限制。最大比例：1.8:1，当前比例：${b.toFixed(2)}:1`}return a.duration&&a.duration>30?`视频时长超出限制。最大时长：30秒，当前时长：${Math.round(a.duration)}秒`:null})(a);b&&(K(b),r())}},R=async()=>{let b=a?a.uploadUrl?null:"视频文件尚未上传完成，请稍候":"请先上传视频文件";if(b)return void K(b);G(!0),K(null),v();try{let b=await (0,aH.Zn)({model:y,video_url:a.uploadUrl||"",style:A,video_fps:C});b.success&&b.data?(I([{id:Date.now(),src:b.data.output.output_video_url}]),M(0)):K(b.error||"提交视频生成任务失败")}catch(a){K(a instanceof Error?a.message:"生成视频时发生未知错误")}finally{G(!1),w()}},S=async()=>{if(0!==H.length)try{await (0,aG.rT)(H,L)}catch(a){console.error("下载失败:",a),K("下载失败，请重试")}};return(0,f.jsxs)("div",{className:"bg-[#0D0D12] min-h-screen text-white",children:[(0,f.jsx)(h.A,{}),(0,f.jsx)(i.A,{}),(0,f.jsx)("main",{className:"ml-20 pt-14",children:(0,f.jsxs)("div",{className:"flex h-[calc(100vh-56px)] p-4 gap-4",children:[(0,f.jsxs)("div",{className:"w-[380px] bg-[#24222D] p-4 flex flex-col",children:[(0,f.jsxs)("div",{className:"flex-1 overflow-y-auto space-y-6",children:[(0,f.jsx)("h1",{className:"text-xl",children:"视频转视频AI"}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"模型选择"}),(0,f.jsx)(aF.t,{options:aK.map(a=>({value:a.value,label:a.label,description:a.description,icon:a.icon})),value:y,onValueChange:z,variant:"dark",size:"lg",renderTrigger:a=>a?(0,f.jsxs)("div",{className:"flex items-center gap-3 py-1",children:[(0,f.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gray-700 flex items-center justify-center",children:(0,f.jsx)(o.default,{src:a.icon||"/image/com-logo-hunyuan.svg",alt:a.label,width:24,height:24,unoptimized:!0})}),(0,f.jsxs)("div",{className:"text-left",children:[(0,f.jsx)("p",{className:"text-sm text-white",children:a.label}),(0,f.jsx)("p",{className:"text-xs text-gray-400",children:a.description})]})]}):null,renderItem:a=>(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("div",{className:"w-8 h-8 rounded-md bg-gray-700 flex items-center justify-center",children:(0,f.jsx)(o.default,{src:a.icon||"/image/com-logo-hunyuan.svg",alt:a.label,width:20,height:20,unoptimized:!0})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-white",children:a.label}),(0,f.jsx)("p",{className:"text-xs text-gray-400",children:a.description})]})]})})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"上传视频"}),(0,f.jsx)(u,{onFileSelect:Q,onVideoRemove:()=>{r(),K(null)},uploadedVideo:a,disabled:F,error:c||J,isUploading:b,uploadProgress:d}),a?.uploadUrl&&(0,f.jsx)("div",{className:"mt-2 text-sm text-green-400 bg-green-500/10 border border-green-500/20 rounded-lg p-3",children:"✓ 视频已成功上传"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"风格选择"}),(0,f.jsx)(aF.t,{options:aJ.map(a=>({value:a.id.toString(),label:a.name,description:a.description,icon:a.image})),value:A.toString(),onValueChange:a=>B(parseInt(a)),variant:"dark",size:"lg",renderTrigger:a=>a?(0,f.jsx)("div",{className:"flex items-center gap-3 py-1",children:(0,f.jsxs)("div",{className:"text-left",children:[(0,f.jsx)("p",{className:"text-sm text-white",children:a.label}),(0,f.jsx)("p",{className:"text-xs text-gray-400",children:a.description})]})}):null,renderItem:a=>(0,f.jsx)("div",{className:"flex items-center gap-3",children:(0,f.jsxs)("div",{children:[(0,f.jsx)("p",{className:"text-white",children:a.label}),(0,f.jsx)("p",{className:"text-xs text-gray-400",children:a.description})]})})})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm text-gray-300 mb-2",children:"视频帧率"}),(0,f.jsx)("div",{className:"flex gap-2",children:aL.map(a=>(0,f.jsxs)(p.$,{variant:C===a.value?"default":"outline",onClick:()=>E(a.value),className:(0,n.cn)("flex-1 flex-col h-auto py-2",C===a.value?"bg-primary hover:bg-primary/90":"bg-[#383842] border-[#4a4a54] hover:bg-[#4a4a54] hover:text-white"),children:[(0,f.jsx)("span",{className:"text-sm font-medium",children:a.label}),(0,f.jsx)("span",{className:"text-xs opacity-70",children:a.description})]},a.value))})]}),(0,f.jsxs)("div",{className:"bg-[#383842] rounded-lg p-3 space-y-2",children:[(0,f.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-300",children:[(0,f.jsx)(j.A,{className:"w-4 h-4"}),(0,f.jsx)("span",{children:"视频要求"})]}),(0,f.jsxs)("div",{className:"text-xs text-gray-400 space-y-1",children:[(0,f.jsxs)("p",{children:["• 支持格式：",N.join(", ")]}),(0,f.jsxs)("p",{children:["• 文件大小：不超过 ",100,"MB"]}),(0,f.jsxs)("p",{children:["• 视频时长：不超过 ",30,"秒"]}),(0,f.jsxs)("p",{children:["• 分辨率：",256,"-",4096,"px，长宽比不超过 ",1.8,":1"]})]})]}),(0,f.jsxs)("div",{className:"flex justify-between text-sm text-gray-400",children:[(0,f.jsxs)("div",{className:"flex items-center gap-1",children:[(0,f.jsx)("span",{children:"所需额度:"}),(0,f.jsx)(j.A,{className:"w-4 h-4"})]}),(0,f.jsx)("span",{className:"text-white",children:"video-style-transform-pro"===y?"200 额度":"video-style-transform-fast"===y?"50 额度":"100 额度"})]})]}),J&&(0,f.jsxs)("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3 flex items-start gap-2 mb-4",children:[(0,f.jsx)(k.A,{className:"w-4 h-4 text-red-400 mt-0.5 flex-shrink-0"}),(0,f.jsx)("div",{className:"text-sm text-red-400",children:J})]}),t&&(0,f.jsx)("div",{className:"bg-[#383842] rounded-lg p-3 mb-4",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsx)("span",{className:"text-sm text-gray-300",children:"生成进度"}),(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-pulse"}),(0,f.jsx)("span",{className:"text-lg font-mono text-primary",children:s})]})]})}),(0,f.jsx)("div",{className:"pt-4 border-t border-gray-700",children:(0,f.jsxs)(p.$,{onClick:R,disabled:!a||!a.uploadUrl||F,className:"w-full h-12 bg-primary hover:bg-primary/90 text-lg",children:[(0,f.jsx)(l.A,{className:(0,n.cn)("w-5 h-5 mr-2",F&&"animate-spin")}),F?`生成中... ${s}`:"生成视频"]})})]}),(0,f.jsxs)("div",{className:"flex flex-col flex-1 bg-[#24222D] p-4",children:[(0,f.jsx)("div",{className:"flex justify-end mb-2",children:(0,f.jsxs)(p.$,{disabled:F,size:"sm",variant:"outline",onClick:S,className:(0,n.cn)("text-xs","bg-[#383842] border-[#4a4a54] text-white","hover:bg-[#FF3466] hover:border-[#FF3466] hover:text-white"),children:[(0,f.jsx)(m.A,{className:"w-4 h-4"}),"下载当前视频"]})}),(0,f.jsx)("div",{className:"flex-1 flex items-center justify-center min-h-0 overflow-hidden",children:(0,f.jsx)(q.s,{videos:H,className:"w-full h-full max-w-full max-h-full",onCurrentChange:a=>{M(a)},autoPlay:!0,showThumbnails:!0})})]})]})})]})}},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},45287:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(1646).registerClientReference)(function(){throw Error("Attempted to call the default export of \"E:\\\\MySpace\\\\ai-video\\\\src\\\\app\\\\video-to-video\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"E:\\MySpace\\ai-video\\src\\app\\video-to-video\\page.tsx","default")},49370:(a,b,c)=>{Promise.resolve().then(c.bind(c,39580))},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66488:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(55022),e=c(41977),f=c(66191),g=c(17008),h=c(55122),i=c(50028),j=c(72075),k=c(29032),l=c(3166),m=c(71164),n=c(50894),o=c(28721),p=c(13209),q=c(94410),r=c(261),s=c(19177),t=c(16694),u=c(26713),v=c(3712),w=c(2465),x=c(60437),y=c(51794),z=c(32830),A=c(82250),B=c(86439),C=c(66790),D=c.n(C),E=c(79150),F=c(97751),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["video-to-video",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,45287)),"E:\\MySpace\\ai-video\\src\\app\\video-to-video\\page.tsx"]}]},{metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,83398))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,32636)),"E:\\MySpace\\ai-video\\src\\app\\layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,66790,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,52512,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,27537,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,45700,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,83398))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,I=["E:\\MySpace\\ai-video\\src\\app\\video-to-video\\page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/video-to-video/page",pathname:"/video-to-video",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/video-to-video/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw aF||b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},98741:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(15988).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}};var b=require("../../webpack-runtime.js");b.C(a);var c=b.X(0,[306,863,736,694,831,342],()=>b(b.s=66488));module.exports=c})();